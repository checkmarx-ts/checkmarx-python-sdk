openapi: 3.0.1
info:
  contact: {}
  title: SSCS API - Reader
  version: "1.0"
paths:
  /read/predicates/{similarity-id}:
    get:
      operationId: GetPredicatesHistory
      parameters:
        - description: string valid
          in: path
          name: similarity-id
          required: true
          schema:
            type: string
        - description: string valid
          explode: false
          in: query
          name: project-ids
          schema:
            items:
              type: string
            type: array
          style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredicateHistoryCollection'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
  /read/projects:
    get:
      operationId: GetProjects
      parameters:
        - description: int valid
          in: query
          name: pageSize
          schema:
            type: integer
        - description: int valid
          in: query
          name: currentPage
          schema:
            type: integer
        - description: string valid
          in: query
          name: filters
          schema:
            type: string
        - description: string valid
          in: query
          name: sort
          schema:
            type: string
        - description: string valid
          in: query
          name: search
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Projects'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
  /read/projects/{project}:
    get:
      operationId: GetProject
      parameters:
        - description: string valid
          in: path
          name: project
          required: true
          schema:
            type: string
        - description: string valid
          in: query
          name: scan
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
  /read/results/{project}/{scan}/{engine}:
    get:
      operationId: GetEngineResultsByProject
      parameters:
        - description: string valid
          in: path
          name: project
          required: true
          schema:
            type: string
        - description: string valid
          in: path
          name: engine
          required: true
          schema:
            type: string
        - description: string valid
          in: path
          name: scan
          required: true
          schema:
            type: string
        - description: string valid
          in: query
          name: filters
          schema:
            type: string
        - description: int valid
          in: query
          name: pageSize
          schema:
            type: integer
        - description: int valid
          in: query
          name: currentPage
          schema:
            type: integer
        - description: string valid
          in: query
          name: sort
          schema:
            type: string
        - description: string valid
          in: query
          name: search
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EngineResults'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
  /read/results/{project}/{scan}/{engine}/groups/{column}:
    get:
      operationId: GetGroupsByProjectScan
      parameters:
        - description: string valid
          in: path
          name: project
          required: true
          schema:
            type: string
        - description: string valid
          in: path
          name: scan
          required: true
          schema:
            type: string
        - description: string valid
          in: path
          name: engine
          required: true
          schema:
            type: string
        - description: string valid
          in: path
          name: column
          required: true
          schema:
            type: string
        - description: string valid
          in: query
          name: search
          schema:
            type: string
        - description: string valid
          in: query
          name: filters
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Groups'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Forbidden
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
  /read/scans/{scan}/scan-overview:
    get:
      operationId: GetScanOverview
      parameters:
        - description: string valid
          in: path
          name: scan
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScanOverview'
          description: Ok
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Bad Request
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
          description: Internal Server Error
components:
  schemas:
    Engine:
      enum:
        - 2ms
        - Scorecard
      type: string
      x-enum-varnames:
        - TooMS
        - Scorecard
    EngineFailure:
      example:
        scannedAt: scannedAt
        scanId: scanId
        name: 2ms
        partial: true
      properties:
        name:
          $ref: '#/components/schemas/Engine'
        partial:
          type: boolean
        scanId:
          type: string
        scannedAt:
          type: string
      type: object
    EngineFullName:
      enum:
        - Secret Detection
        - Scorecard
      type: string
      x-enum-varnames:
        - TooMSFullName
        - ScorecardFullName
    EngineOverview:
      example:
        riskSummary:
          key: 0
        name: 2ms
        totalRisks: 6
        fullName: Secret Detection
        status: Completed
      properties:
        fullName:
          $ref: '#/components/schemas/EngineFullName'
        name:
          $ref: '#/components/schemas/Engine'
        riskSummary:
          additionalProperties:
            type: integer
          type: object
        status:
          $ref: '#/components/schemas/ScanStatus'
        totalRisks:
          type: integer
      type: object
    EngineResult:
      example:
        severity: critical
        commitUrl: commitUrl
        lineContent: lineContent
        similarityId: similarityId
        path: path
        remediation: remediation
        remediationAdditional: remediationAdditional
        remediationLink: remediationLink
        id: id
        state: state
        validity: Valid
        lineNumber: 0
        ruleId: ruleId
        isInSource: true
        status: New
      properties:
        commitUrl:
          type: string
        id:
          type: string
        isInSource:
          type: boolean
        lineContent:
          type: string
        lineNumber:
          type: integer
        path:
          type: string
        remediation:
          type: string
        remediationAdditional:
          type: string
        remediationLink:
          type: string
        ruleId:
          type: string
        severity:
          $ref: '#/components/schemas/Severity'
        similarityId:
          type: string
        state:
          type: string
        status:
          $ref: '#/components/schemas/ResultStatus'
        validity:
          $ref: '#/components/schemas/Validity'
      type: object
    EngineResults:
      example:
        entries:
          - severity: critical
            commitUrl: commitUrl
            lineContent: lineContent
            similarityId: similarityId
            path: path
            remediation: remediation
            remediationAdditional: remediationAdditional
            remediationLink: remediationLink
            id: id
            state: state
            validity: Valid
            lineNumber: 0
            ruleId: ruleId
            isInSource: true
            status: New
          - severity: critical
            commitUrl: commitUrl
            lineContent: lineContent
            similarityId: similarityId
            path: path
            remediation: remediation
            remediationAdditional: remediationAdditional
            remediationLink: remediationLink
            id: id
            state: state
            validity: Valid
            lineNumber: 0
            ruleId: ruleId
            isInSource: true
            status: New
        totalCount: 6
      properties:
        entries:
          items:
            $ref: '#/components/schemas/EngineResult'
          type: array
        totalCount:
          type: integer
      type: object
    Group:
      example:
        metadata:
          severity: critical
          ruleName: ruleName
          ruleDescription: ruleDescription
        count: 0
        columnValue: columnValue
      properties:
        columnValue:
          type: string
        count:
          type: integer
        metadata:
          $ref: '#/components/schemas/RuleInfo'
      type: object
    Groups:
      example:
        entries:
          - metadata:
              severity: critical
              ruleName: ruleName
              ruleDescription: ruleDescription
            count: 0
            columnValue: columnValue
          - metadata:
              severity: critical
              ruleName: ruleName
              ruleDescription: ruleDescription
            count: 0
            columnValue: columnValue
      properties:
        entries:
          items:
            $ref: '#/components/schemas/Group'
          type: array
      type: object
    PredicateAPI:
      example:
        severity: severity
        createdAt: createdAt
        createdBy: createdBy
        comment: comment
        id: id
        state: state
        projectId: projectId
        similarityId: similarityId
      properties:
        comment:
          type: string
        createdAt:
          type: string
        createdBy:
          type: string
        id:
          type: string
        projectId:
          type: string
        severity:
          type: string
        similarityId:
          type: string
        state:
          type: string
      type: object
    PredicateHistory:
      example:
        originalSeverity: originalSeverity
        predicates:
          - severity: severity
            createdAt: createdAt
            createdBy: createdBy
            comment: comment
            id: id
            state: state
            projectId: projectId
            similarityId: similarityId
          - severity: severity
            createdAt: createdAt
            createdBy: createdBy
            comment: comment
            id: id
            state: state
            projectId: projectId
            similarityId: similarityId
        totalCount: 0
        projectId: projectId
        similarityId: similarityId
      properties:
        originalSeverity:
          type: string
        predicates:
          items:
            $ref: '#/components/schemas/PredicateAPI'
          type: array
        projectId:
          type: string
        similarityId:
          type: string
        totalCount:
          type: integer
      type: object
    PredicateHistoryCollection:
      example:
        predicateHistoryPerProject:
          - originalSeverity: originalSeverity
            predicates:
              - severity: severity
                createdAt: createdAt
                createdBy: createdBy
                comment: comment
                id: id
                state: state
                projectId: projectId
                similarityId: similarityId
              - severity: severity
                createdAt: createdAt
                createdBy: createdBy
                comment: comment
                id: id
                state: state
                projectId: projectId
                similarityId: similarityId
            totalCount: 0
            projectId: projectId
            similarityId: similarityId
          - originalSeverity: originalSeverity
            predicates:
              - severity: severity
                createdAt: createdAt
                createdBy: createdBy
                comment: comment
                id: id
                state: state
                projectId: projectId
                similarityId: similarityId
              - severity: severity
                createdAt: createdAt
                createdBy: createdBy
                comment: comment
                id: id
                state: state
                projectId: projectId
                similarityId: similarityId
            totalCount: 0
            projectId: projectId
            similarityId: similarityId
        totalCount: 6
      properties:
        predicateHistoryPerProject:
          items:
            $ref: '#/components/schemas/PredicateHistory'
          type: array
        totalCount:
          type: integer
      type: object
    Project:
      example:
        slsaStep:
          - Source
          - Source
        riskLevel:
          key: 6
        engines:
          key: 0
        enginesFailures:
          - scannedAt: scannedAt
            scanId: scanId
            name: 2ms
            partial: true
          - scannedAt: scannedAt
            scanId: scanId
            name: 2ms
            partial: true
        lastScanMetadata:
          scannedAt: scannedAt
          id: id
        name: name
        id: id
      properties:
        engines:
          additionalProperties:
            type: integer
          type: object
        enginesFailures:
          items:
            $ref: '#/components/schemas/EngineFailure'
          type: array
        id:
          type: string
        lastScanMetadata:
          $ref: '#/components/schemas/ScanInfo'
        name:
          type: string
        riskLevel:
          additionalProperties:
            type: integer
          type: object
        slsaStep:
          items:
            $ref: '#/components/schemas/SlsaStep'
          type: array
      type: object
    Projects:
      example:
        entries:
          - slsaStep:
              - Source
              - Source
            riskLevel:
              key: 6
            engines:
              key: 0
            enginesFailures:
              - scannedAt: scannedAt
                scanId: scanId
                name: 2ms
                partial: true
              - scannedAt: scannedAt
                scanId: scanId
                name: 2ms
                partial: true
            lastScanMetadata:
              scannedAt: scannedAt
              id: id
            name: name
            id: id
          - slsaStep:
              - Source
              - Source
            riskLevel:
              key: 6
            engines:
              key: 0
            enginesFailures:
              - scannedAt: scannedAt
                scanId: scanId
                name: 2ms
                partial: true
              - scannedAt: scannedAt
                scanId: scanId
                name: 2ms
                partial: true
            lastScanMetadata:
              scannedAt: scannedAt
              id: id
            name: name
            id: id
        totalFilteredCount: 5
        totalCount: 1
      properties:
        entries:
          items:
            $ref: '#/components/schemas/Project'
          type: array
        totalCount:
          type: integer
        totalFilteredCount:
          type: integer
      type: object
    ResultStatus:
      enum:
        - New
        - Recurrent
        - Fixed
      type: string
      x-enum-varnames:
        - New
        - Recurrent
        - Fixed
    RuleInfo:
      example:
        severity: critical
        ruleName: ruleName
        ruleDescription: ruleDescription
      properties:
        ruleDescription:
          type: string
        ruleName:
          type: string
        severity:
          $ref: '#/components/schemas/Severity'
      type: object
    ScanInfo:
      example:
        scannedAt: scannedAt
        id: id
      properties:
        id:
          type: string
        scannedAt:
          type: string
      type: object
    ScanOverview:
      example:
        riskSummary:
          key: 1
        totalRisks: 5
        id: id
        projectId: projectId
        engineOverviews:
          - riskSummary:
              key: 0
            name: 2ms
            totalRisks: 6
            fullName: Secret Detection
            status: Completed
          - riskSummary:
              key: 0
            name: 2ms
            totalRisks: 6
            fullName: Secret Detection
            status: Completed
        status: null
      properties:
        engineOverviews:
          items:
            $ref: '#/components/schemas/EngineOverview'
          type: array
        id:
          type: string
        projectId:
          type: string
        riskSummary:
          additionalProperties:
            type: integer
          type: object
        status:
          $ref: '#/components/schemas/ScanStatus'
        totalRisks:
          type: integer
      type: object
    ScanStatus:
      enum:
        - Completed
        - Partial
        - Failed
        - Running
      type: string
      x-enum-varnames:
        - Completed
        - Partial
        - Failed
        - Running
    Severity:
      enum:
        - critical
        - high
        - medium
        - low
        - info
      type: string
      x-enum-varnames:
        - Critical
        - High
        - Medium
        - Low
        - Info
    SlsaStep:
      enum:
        - Source
        - Build
        - Package
        - Dependencies
      type: string
      x-enum-varnames:
        - Source
        - Build
        - Package
        - Dependencies
    Validity:
      enum:
        - Valid
        - Unknown
        - Invalid
      type: string
      x-enum-varnames:
        - Valid
        - Unknown
        - Invalid
    Error:
      example:
        code: 1
        message: message
        type: type
      properties:
        code:
          type: integer
        message:
          type: string
        type:
          type: string
      type: object
  securitySchemes:
    Login:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: /spec/cxauth.html
          scopes: {}
x-original-swagger-version: "2.0"
servers:
  - url: /api/micro-engines
security:
  - Login: []
